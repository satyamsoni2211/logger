"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("moment"),t=require("axios");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s,o,i=r(e),n=r(t);exports.Levels=void 0,(s=exports.Levels||(exports.Levels={}))[s.not_set=0]="not_set",s[s.debug=1]="debug",s[s.info=2]="info",s[s.warn=3]="warn",s[s.error=4]="error",s[s.critical=5]="critical",function(e){e.not_set="NOT_SET",e.debug="DEBUG",e.info="INFO",e.warn="WARN",e.error="ERROR",e.critical="CRITICAL"}(o||(o={}));class l{event;level;levelNo;extra;context_key;args=[];time;constructor(e,t,r=o.debug,s,i={},n="",l=[]){this.event=e,this.level=r,this.time=s,this.extra=i,this.context_key=n,this.args=l,this.levelNo=t,this.getMessage=this.getMessage.bind(this),this.getTimeInMilliseconds=this.getTimeInMilliseconds.bind(this),this.getIsoFormatTime=this.getIsoFormatTime.bind(this),this.getFormattedTime=this.getFormattedTime.bind(this)}getMessage(){return this.event}getTimeInMilliseconds(){return this.time}getIsoFormatTime(){return i.default.unix(this.time).toISOString()}getFormattedTime(e="YYYY-MM-DD HH:mm:ss ZZ"){return i.default.unix(this.time).format(e)}}const a=()=>i.default().unix();class c{handlers=[];level=0;addHandler(e){this.handlers.push(e)}setLevel(e){this.level=e}createRecord(e,t,r,s,o={}){return new l(e,t,r,s,o)}handle(e){for(const t of this.handlers)t.emit(e)}filter_record(e,t){return e>exports.Levels.not_set&&e<=t||e===exports.Levels.not_set}info(e,t={}){if(this.filter_record(this.level,exports.Levels.info)){const r=this.createRecord(e,exports.Levels.info,o.info,a(),t);this.handle(r)}}debug(e,t={}){if(this.filter_record(this.level,exports.Levels.debug)){const r=this.createRecord(e,exports.Levels.debug,o.debug,a(),t);this.handle(r)}}warn(e,t={}){if(this.filter_record(this.level,exports.Levels.warn)){const r=this.createRecord(e,exports.Levels.warn,o.warn,a(),t);this.handle(r)}}error(e,t={}){if(this.filter_record(this.level,exports.Levels.error)){const r=this.createRecord(e,exports.Levels.error,o.error,a(),t);this.handle(r)}}critical(e,t={}){if(this.filter_record(this.level,exports.Levels.critical)){const r=this.createRecord(e,exports.Levels.critical,o.critical,a(),t);this.handle(r)}}}class h{formatter;level;constructor(){this.level=1}setFormatter(e){this.formatter=e}setLevel(e){this.level=e}filter(e){return this.level<=e}}class d{format(e){return this.formatRecord(e)}}class u extends h{getConsoleMethod(e){let t;switch(e.toLowerCase()){case"debug":t=console.debug;break;case"info":t=console.info;break;case"warn":t=console.warn;break;case"critical":case"error":t=console.error;break;default:t=console.log}return t}emit(e){if(this.filter(e.levelNo)){const t=this.formatter.format(e);this.getConsoleMethod(e.level).call(this,t)}}}var f=Object.freeze({__proto__:null,ConsoleHandler:u,StreamHandler:class extends h{endpoint;constructor(e){super(),this.endpoint=e.endpoint}postToSumo(e){n.default.post(this.endpoint,e,{headers:{"Content-Type":"application/json"}}).then((e=>{console.log(e.data)}))}emit(e){const t=this.formatter.format(e);this.postToSumo(t)}}});class g extends d{formatRecord(e){return`[${e.level}] ${e.getIsoFormatTime()} ${e.getMessage()}`.replace(/\$\{(\S+)\}/g,(function(t){let r=t.slice(2,t.length-1);return e.extra[r]||t}))}}var m=Object.freeze({__proto__:null,BasicFormatter:g,JSONFormatter:class extends d{isError(e){return e instanceof Error}getStack(e){const t=e.getMessage();if(this.isError(t))return t.stack}interpolateRecord(e,t){return e.replace(/\$\{(\S+)\}/g,(function(e){let r=e.slice(2,e.length-1);return t[r]||e}))}formatMessage(e){const t=e.getMessage();let r;return r=t instanceof Error?`${t.message}`:this.interpolateRecord(t,e.extra),r}formatRecord(e){const t={message:this.formatMessage(e),timestamp:e.getIsoFormatTime(),level:e.level,context:e.extra,user:e.extra?.user};return this.isError(e.getMessage())&&(t.stack_info=this.getStack(e)),JSON.stringify(t)}}});var v=Object.freeze({__proto__:null,get_basic_logger:function(){const e=new c,t=new u,r=new g;return t.setFormatter(r),e.addHandler(t),e},get_custom_logger:function(e){const{handlers:t=[new u],level:r=1,formatter:s=new g}=e,o=new c;return t.forEach((e=>{e.setLevel(r),e.setFormatter(s),o.addHandler(e)})),o}});exports.Logger=c,exports.formatters=m,exports.handlers=f,exports.utils=v;
//# sourceMappingURL=index.cjs.map
