import e from"moment";import t from"axios";var r,s;!function(e){e[e.not_set=0]="not_set",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.critical=5]="critical"}(r||(r={})),function(e){e.not_set="NOT_SET",e.debug="DEBUG",e.info="INFO",e.warn="WARN",e.error="ERROR",e.critical="CRITICAL"}(s||(s={}));class o{event;level;levelNo;extra;context_key;args=[];time;constructor(e,t,r=s.debug,o,i={},n="",a=[]){this.event=e,this.level=r,this.time=o,this.extra=i,this.context_key=n,this.args=a,this.levelNo=t,this.getMessage=this.getMessage.bind(this),this.getTimeInMilliseconds=this.getTimeInMilliseconds.bind(this),this.getIsoFormatTime=this.getIsoFormatTime.bind(this),this.getFormattedTime=this.getFormattedTime.bind(this)}getMessage(){return this.event}getTimeInMilliseconds(){return this.time}getIsoFormatTime(){return e.unix(this.time).toISOString()}getFormattedTime(t="YYYY-MM-DD HH:mm:ss ZZ"){return e.unix(this.time).format(t)}}const i=()=>e().unix();class n{handlers=[];level=0;addHandler(e){this.handlers.push(e)}setLevel(e){this.level=e}createRecord(e,t,r,s,i={}){return new o(e,t,r,s,i)}handle(e){for(const t of this.handlers)t.emit(e)}filter_record(e,t){return e>r.not_set&&e<=t||e===r.not_set}info(e,t={}){if(this.filter_record(this.level,r.info)){const o=this.createRecord(e,r.info,s.info,i(),t);this.handle(o)}}debug(e,t={}){if(this.filter_record(this.level,r.debug)){const o=this.createRecord(e,r.debug,s.debug,i(),t);this.handle(o)}}warn(e,t={}){if(this.filter_record(this.level,r.warn)){const o=this.createRecord(e,r.warn,s.warn,i(),t);this.handle(o)}}error(e,t={}){if(this.filter_record(this.level,r.error)){const o=this.createRecord(e,r.error,s.error,i(),t);this.handle(o)}}critical(e,t={}){if(this.filter_record(this.level,r.critical)){const o=this.createRecord(e,r.critical,s.critical,i(),t);this.handle(o)}}}class a{formatter;level;constructor(){this.level=1}setFormatter(e){this.formatter=e}setLevel(e){this.level=e}filter(e){return this.level<=e}}class l{format(e){return this.formatRecord(e)}}class c extends a{getConsoleMethod(e){let t;switch(e.toLowerCase()){case"debug":t=console.debug;break;case"info":t=console.info;break;case"warn":t=console.warn;break;case"critical":case"error":t=console.error;break;default:t=console.log}return t}emit(e){if(this.filter(e.levelNo)){const t=this.formatter.format(e);this.getConsoleMethod(e.level).call(this,t)}}}var h=Object.freeze({__proto__:null,ConsoleHandler:c,StreamHandler:class extends a{endpoint;constructor(e){super(),this.endpoint=e.endpoint}postToSumo(e){t.post(this.endpoint,e,{headers:{"Content-Type":"application/json"}}).then((e=>{console.log(e.data)}))}emit(e){const t=this.formatter.format(e);this.postToSumo(t)}}});class d extends l{formatRecord(e){return`[${e.level}] ${e.getIsoFormatTime()} ${e.getMessage()}`.replace(/\$\{(\S+)\}/g,(function(t){let r=t.slice(2,t.length-1);return e.extra[r]||t}))}}var m=Object.freeze({__proto__:null,BasicFormatter:d,JSONFormatter:class extends l{isError(e){return e instanceof Error}getStack(e){const t=e.getMessage();if(this.isError(t))return t.stack}interpolateRecord(e,t){return e.replace(/\$\{(\S+)\}/g,(function(e){let r=e.slice(2,e.length-1);return t[r]||e}))}formatMessage(e){const t=e.getMessage();let r;return r=t instanceof Error?`${t.message}`:this.interpolateRecord(t,e.extra),r}formatRecord(e){const t={message:this.formatMessage(e),timestamp:e.getIsoFormatTime(),level:e.level,context:e.extra,user:e.extra?.user};return this.isError(e.getMessage())&&(t.stack_info=this.getStack(e)),JSON.stringify(t)}}});var g=Object.freeze({__proto__:null,get_basic_logger:function(){const e=new n,t=new c,r=new d;return t.setFormatter(r),e.addHandler(t),e},get_custom_logger:function(e){const{handlers:t=[new c],level:r=1,formatter:s=new d}=e,o=new n;return t.forEach((e=>{e.setLevel(r),e.setFormatter(s),o.addHandler(e)})),o}});export{r as Levels,n as Logger,m as formatters,h as handlers,g as utils};
//# sourceMappingURL=index.mjs.map
