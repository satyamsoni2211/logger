System.register(["moment","axios"],(function(e){"use strict";var t,r;return{setters:[function(e){t=e.default},function(e){r=e.default}],execute:function(){var s,o;e("Levels",s),function(e){e[e.not_set=0]="not_set",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.critical=5]="critical"}(s||e("Levels",s={})),function(e){e.not_set="NOT_SET",e.debug="DEBUG",e.info="INFO",e.warn="WARN",e.error="ERROR",e.critical="CRITICAL"}(o||(o={}));class i{event;level;levelNo;extra;context_key;args=[];time;constructor(e,t,r=o.debug,s,i={},n="",a=[]){this.event=e,this.level=r,this.time=s,this.extra=i,this.context_key=n,this.args=a,this.levelNo=t,this.getMessage=this.getMessage.bind(this),this.getTimeInMilliseconds=this.getTimeInMilliseconds.bind(this),this.getIsoFormatTime=this.getIsoFormatTime.bind(this),this.getFormattedTime=this.getFormattedTime.bind(this)}getMessage(){return this.event}getTimeInMilliseconds(){return this.time}getIsoFormatTime(){return t.unix(this.time).toISOString()}getFormattedTime(e="YYYY-MM-DD HH:mm:ss ZZ"){return t.unix(this.time).format(e)}}const n=()=>t().unix();class a{handlers=[];level=0;addHandler(e){this.handlers.push(e)}setLevel(e){this.level=e}createRecord(e,t,r,s,o={}){return new i(e,t,r,s,o)}handle(e){for(const t of this.handlers)t.emit(e)}filter_record(e,t){return e>s.not_set&&e<=t||e===s.not_set}info(e,t={}){if(this.filter_record(this.level,s.info)){const r=this.createRecord(e,s.info,o.info,n(),t);this.handle(r)}}debug(e,t={}){if(this.filter_record(this.level,s.debug)){const r=this.createRecord(e,s.debug,o.debug,n(),t);this.handle(r)}}warn(e,t={}){if(this.filter_record(this.level,s.warn)){const r=this.createRecord(e,s.warn,o.warn,n(),t);this.handle(r)}}error(e,t={}){if(this.filter_record(this.level,s.error)){const r=this.createRecord(e,s.error,o.error,n(),t);this.handle(r)}}critical(e,t={}){if(this.filter_record(this.level,s.critical)){const r=this.createRecord(e,s.critical,o.critical,n(),t);this.handle(r)}}}e("Logger",a);class l{formatter;level;constructor(){this.level=1}setFormatter(e){this.formatter=e}setLevel(e){this.level=e}filter(e){return this.level<=e}}class c{format(e){return this.formatRecord(e)}}class h extends l{getConsoleMethod(e){let t;switch(e.toLowerCase()){case"debug":t=console.debug;break;case"info":t=console.info;break;case"warn":t=console.warn;break;case"critical":case"error":t=console.error;break;default:t=console.log}return t}emit(e){if(this.filter(e.levelNo)){const t=this.formatter.format(e);this.getConsoleMethod(e.level).call(this,t)}}}e("handlers",Object.freeze({__proto__:null,ConsoleHandler:h,StreamHandler:class extends l{endpoint;constructor(e){super(),this.endpoint=e.endpoint}postToSumo(e){r.post(this.endpoint,e,{headers:{"Content-Type":"application/json"}}).then((e=>{console.log(e.data)}))}emit(e){const t=this.formatter.format(e);this.postToSumo(t)}}}));class d extends c{formatRecord(e){return`[${e.level}] ${e.getIsoFormatTime()} ${e.getMessage()}`.replace(/\$\{(\S+)\}/g,(function(t){let r=t.slice(2,t.length-1);return e.extra[r]||t}))}}e("formatters",Object.freeze({__proto__:null,BasicFormatter:d,JSONFormatter:class extends c{isError(e){return e instanceof Error}getStack(e){const t=e.getMessage();if(this.isError(t))return t.stack}interpolateRecord(e,t){return e.replace(/\$\{(\S+)\}/g,(function(e){let r=e.slice(2,e.length-1);return t[r]||e}))}formatMessage(e){const t=e.getMessage();let r;return r=t instanceof Error?`${t.message}`:this.interpolateRecord(t,e.extra),r}formatRecord(e){const t={message:this.formatMessage(e),timestamp:e.getIsoFormatTime(),level:e.level,context:e.extra,user:e.extra?.user};return this.isError(e.getMessage())&&(t.stack_info=this.getStack(e)),JSON.stringify(t)}}}));var f=Object.freeze({__proto__:null,get_basic_logger:function(){const e=new a,t=new h,r=new d;return t.setFormatter(r),e.addHandler(t),e},get_custom_logger:function(e){const{handlers:t=[new h],level:r=1,formatter:s=new d}=e,o=new a;return t.forEach((e=>{e.setLevel(r),e.setFormatter(s),o.addHandler(e)})),o}});e("utils",f)}}}));
